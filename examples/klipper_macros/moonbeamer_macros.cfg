[gcode_macro STREAM_ON]
description: Start MoonBeamer RTMP livestream
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="start")}

[gcode_macro STREAM_OFF]
description: Stop MoonBeamer RTMP livestream
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="stop")}

[gcode_macro STREAM_ENABLE]
description: Enable MoonBeamer component
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="enable")}

[gcode_macro STREAM_DISABLE]
description: Disable MoonBeamer component
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="disable")}

[gcode_macro STREAM_PREP_MEDIA]
description: Normalize intro/outro to stream settings
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="prepare_media")}

[gcode_macro STREAM_INTRO_ON]
description: Enable intro playback
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="intro_enable")}

[gcode_macro STREAM_INTRO_OFF]
description: Disable intro playback
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="intro_disable")}

[gcode_macro STREAM_OUTRO_ON]
description: Enable outro playback
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="outro_enable")}

[gcode_macro STREAM_OUTRO_OFF]
description: Disable outro playback
gcode:
  {action_call_remote_method("server.post_rtmp_streamer", op="outro_disable")}

[gcode_macro STREAM_STATUS]
description: Print MoonBeamer status to console
gcode:
  {% set r = printer["webhooks"].query("server/rtmp_streamer") %}
  RESPOND PREFIX=MoonBeamer MSG="Enabled={{ r.enabled }} Streaming={{ r.streaming }} Feeder={{ r.feeder_running }} Uptime={{ r.uptime }}s Build={{ r.build_id }}"
