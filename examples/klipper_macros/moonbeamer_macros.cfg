[gcode_macro STREAM_PREP_MEDIA]
description: Normalize intro/outro for current stream settings
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="prepare_media")}

[gcode_macro STREAM_INTRO_ON]
description: Enable intro clip
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="intro_enable")}

[gcode_macro STREAM_INTRO_OFF]
description: Disable intro clip
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="intro_disable")}

[gcode_macro STREAM_OUTRO_ON]
description: Enable outro clip
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="outro_enable")}

[gcode_macro STREAM_OUTRO_OFF]
description: Disable outro clip
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="outro_disable")}




[gcode_macro STREAM_ON]
description: Start RTMP livestream
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="start")}

[gcode_macro STREAM_OFF]
description: Stop RTMP livestream
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="stop")}

[gcode_macro STREAM_ENABLE]
description: Enable RTMP streaming (auto & manual)
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="enable")}

[gcode_macro STREAM_DISABLE]
description: Disable RTMP streaming
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="disable")}

[gcode_macro STREAM_TOGGLE]
description: Toggle RTMP streaming enable/disable
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="toggle_enable")}

[gcode_macro STREAM_STATUS]
gcode:
    {% set r = printer["webhooks"].query("server/rtmp_streamer") %}
    {% if r["streaming"] %}
        RESPOND PREFIX=stream MSG="RTMP stream is ACTIVE"
    {% else %}
        RESPOND PREFIX=stream MSG="RTMP stream is OFF"
    {% endif %}

[gcode_macro STREAM_SNAPSHOT]
description: Take stream snapshot
gcode:
    {action_call_remote_method("server.post_rtmp_streamer", op="snapshot")}


